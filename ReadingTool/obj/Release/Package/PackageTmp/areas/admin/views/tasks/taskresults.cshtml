@using MongoDB.Bson
@model IEnumerable<MongoDB.Bson.BsonDocument>
           
@{
    ViewBag.Title = "Index";
    int i = 0;
    var tasks = ViewBag.Tasks as Dictionary<ObjectId, SystemTaskModel>;
}

@section submenu { @Html.Partial("_menu") }
<table width="95%" cellpadding="0" cellspacing="0" border="0" class="texts" style="margin-left: 10px">
    <thead>
        <tr>
            <th>Date</th>
            <th>Task</th>
            <th>Success</th>
            <th>Message</th>
            <th>Exception</th>
            <th>&nbsp;</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var task in Model)
        {
            <tr>
                <td>@task.GetValue("Created").AsDateTime</td>
                <td>
                    @if(tasks.ContainsKey(task.GetValue("TaskId").AsObjectId))
                    {
                        @tasks[task.GetValue("TaskId").AsObjectId].Name;
                    }
                    else
                    {
                        <text>Unknown task</text>
                    }
                </td>
                <td>@task.GetValue("Success")</td>
                <td>@task.GetValue("Message")</td>
                <td>@task.GetValue("Exception").ToString()</td>
                <td><button>view</button></td>
            </tr>
        }
    </tbody>
</table>