@model string
@{
    ViewBag.Title = "Manage Groups";
}
@section submenu { @Html.Partial("_menu") }
@section styles {
    <link href="@AppHelper.CssUrl("site/jquery-ui-1.8.17.custom.css")" rel="stylesheet" type="text/css" media="screen, projection"/>
}
@section footer { }
@section bottomJS
{
    <script language="javascript" type="text/javascript">
        var settings = {
            groupId: '@Model',
            url: '@(Html.BuildUrlFromExpression<AjaxGroupsController>(x => x.Index()))',
            groupUrl: '@((ViewData[CacheKeys.URLS] as UrlModel).Groups)',
            afToken: $('#afForm input[name=__RequestVerificationToken]').val(),
            profileUrl: '@(Html.BuildUrlFromExpression<ProfilesController>(x=>x.Index("")))'
        };
        
        var groups = new groupMembershipVM(settings);

        new uiHelper({
            urls: { ajaxUrl: '@((ViewData[CacheKeys.URLS] as UrlModel).Ajax.Base)' },
            tags: [{ name: '#Usernames', endpoint: 'autocompleteusernames'}]
        });

        $('input:radio').live('click', function () {
            if ($(this).is(':checked')) {
                $(this).parent().parent().children().css('background-color', 'inherit');
                $(this).parent().css('background-color', '#FFF4F4');
            }
        });
    </script>
}

@{
    using(Html.BeginForm<GroupsController>(x => x.Manage(Model), FormMethod.Post, new { id = "afForm" }))
    { 
        @Html.AntiForgeryToken()
        <div id="wrapper">
            <div id="leftbar">
                <strong style="padding-left:20px">Filters</strong>
                <div class="clr5"></div><hr /><div class="clr5"></div>
                <ul class="ffolder">
                    @foreach(var folder in FilterKeys.GroupManageTypes)
                    {
                        <li>
                            <div style="width:100%">
                                <span>@folder</span>
                                <div style="float: right; width: 15px">
                                    <input type="checkbox" name="folders" value="@folder" data-bind="checked: selectedFolders"/>
                                </div>
                            </div>
                        </li>
                    }
                </ul>
            </div>
            <div id="main">
                <div style="height:30px">
                    <ul class="top">
                        <li>
                            <a title="edit group" href="@(Html.BuildUrlFromExpression<GroupsController>(x => x.Edit(Model)))" class="sprite spritesedit-edit">edit group</a>
                        </li>
                        <li>
                            <a title="view group" href="@(Html.BuildUrlFromExpression<GroupsController>(x => x.View(Model)))" class="sprite spritesedit-read">view group</a>
                        </li>
                    </ul>
                </div>
                <table class="texts" width="100%" cellspacing="0" cellpadding="0">
                    <thead>
                        <tr>
                            <tr>
                                <th style="width: 150px">Currently</th>
                                <th style="width: 250px">User</th>
                                <th style="width: 150px">Do Nothing</th>
                                <th style="width: 150px">Moderator</th>
                                <th style="width: 150px">Member</th>
                                <th style="width: 150px">Ban</th>
                                <th style="width: 150px">Remove</th>
                            </tr>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: items">
                        <tr>
                            <td data-bind="text: type"></td>
                            <td>
                                <a target="_blank" data-bind="attr: { href: settings.profileUrl + '/' + user.username, title: user.name}, text: user.name" ></a>
                            </td>
                            <td><input type="radio" data-bind="attr: { name: user.id }, value: 'nothing', visible: type!='Owner' " /></td>
                            <td><input type="radio" data-bind="attr: { name: user.id }, value: 'moderator', visible: type!='Owner' && type!='Invitation'" /></td>
                            <td><input type="radio" data-bind="attr: { name: user.id }, value: 'member', visible: type!='Owner' && type!='Invitation'" /></td>
                            <td><input type="radio" data-bind="attr: { name: user.id }, value: 'banned', visible: type!='Owner' && type!='Invitation'" /></td>
                            <td><input type="radio" data-bind="attr: { name: user.id }, value: 'remove', visible: type!='Owner'" /></td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <th colspan="7">
                                <ul class="lra" style="padding-left:6px" >
                                    <li class="current first" data-bind="text: 'Showing Page: ' + currentPage()"></li>
                                    <li class="current" data-bind="text: 'Total Groups: ' + totalItems()"></li>
                                    <!-- ko foreach: paging -->
                                    <li><a href="#"data-bind="text: $data, click: $parent.changePage"></a></li>
                                    <!-- /ko -->
                                </ul>
                            </th>
                        </tr>
                    </tfoot>
                </table>
                <button type="submit">
                    <span>save changes</span>
                </button>
            </div>
        </div>
    }
}
<div class="clr20"></div>
<hr />
<div class="clr10"></div>
@{
    using(Html.BeginForm<GroupsController>(x => x.AddUsers(Model), FormMethod.Post))
    {
        @Html.AntiForgeryToken()
        <div class="input_wrapper">
            <label for="Usernames">Usernames to invite:</label>
            @Html.TextArea("Usernames", (string)ViewData["Usernames"])
        </div>
    
        <div class="clr20"></div>
        <button type="submit">
            <span>invite these users</span>
        </button>               
    }
}