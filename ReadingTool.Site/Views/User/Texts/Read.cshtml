@using ReadingTool.Core
@model ReadingTool.Site.Models.User.ReadViewModel
@{
    ViewBag.Title = "Read";
    string[] scripts = new[]
        {
            @"<script src=""" + Url.Content("~/Scripts/reading/audio.js") + @""" type=""text/javascript""></script>", 
            @"<script src=""" + Url.Content("~/Scripts/reading/settings.js") + @""" type=""text/javascript""></script>", 
            @"<script src=""" + Url.Content("~/Scripts/reading/modal.js") + @""" type=""text/javascript""></script>", 
            @"<script src=""" + Url.Content("~/Scripts/reading/readingui.js") + @""" type=""text/javascript""></script>", 
        };

    if(!Html.IsDebug())
    {
        scripts = scripts.Select(x => x.Replace(".js", ".min.js")).ToArray();
    }

    Bundles.Reference("Scripts/other/head/handlebars/handlebars-1.0.rc.1.js");
    Bundles.Reference("Scripts/other/footer/reading/reading.css");

    Bundles.AddInlineScript(
        @<text>
             <script type="text/javascript">
                 var ui;
                 $(function() {
                     var settings = new Settings();
                     settings.classes.knownClass = '@Constants.TermStates.KNOWN';
                     settings.classes.unknownClass = '@Constants.TermStates.UNKNOWN';
                     settings.classes.ignoredClass = '@Constants.TermStates.IGNORED';
                     settings.classes.notseenClass = '@Constants.TermStates.NOTSEEN';
                     settings.classes.spaceClass = '@Constants.TermStates.SPACE';
                     settings.classes.punctuationClass = '@Constants.TermStates.PUNCTUATION';
                     settings.classes.multiClass = 'mxx';

                     settings.hasAudio = @(!string.IsNullOrEmpty(Model.Text.AudioUrl) ? "true" : "false");
                     settings.audioUrl = '@Model.Text.AudioUrl';
                     settings.textId = '@Model.Text.Id';
                     settings.languageId = '@Model.Language.Id';
                     settings.modalBehaviour = '@Model.Language.Settings.ModalBehaviour';
                     settings.ajaxUrl = '@Url.Action("Index", "Reading")';
                     settings.asParallel = @Model.AsParallel.ToString().ToLowerInvariant();
                     ui = new ReadingToolUi(settings);
                 });
             </script>
             @Html.Raw(string.Join("\n", scripts))
         </text>
        , "body");
}

@Html.Partial("Partials/_textarea", Model, ViewData)
@Html.Partial("Partials/_textmodal", Model, ViewData)
@Html.Partial("Partials/_templates", Model, ViewData)

@{
    Bundles.AddInlineScript(
        @<text>
             <script language="javascript" type="text/javascript">
                 //var source = $("#term-template").html();
                 //var template = Handlebars.compile(source);
                 //var html = template({ "id": "00000000-0000-0000-0000-000000000001", "languageId": "ad519721-f469-b23b-c082-39beeeadae88", "owner": "3dbbb92b-2d70-a471-9931-39beeea9a2ff", "termPhrase": "lorem", "length": 1, "individualTerms": [{ "id": "10000000-0000-0000-0000-000000000000", "created": "2012-12-28T20:31:20.3924633+00:00", "modified": "2012-12-28T20:31:20.3924633+00:00", "textId": "7dc4a5f7-43ef-6509-c16b-39bef0a24203", "termId": "00000000-0000-0000-0000-000000000001", "baseTerm": "lorem base1", "sentence": "Sentence 1", "definition": "Definition 1", "romanisation": "Romanisation1", "tags": "tag1-1 " }, { "id": "20000000-0000-0000-0000-000000000000", "created": "2012-12-28T20:31:20.3934633+00:00", "modified": "2012-12-28T20:31:20.3934633+00:00", "textId": "7dc4a5f7-43ef-6509-c16b-39bef0a24203", "termId": "00000000-0000-0000-0000-000000000001", "baseTerm": "lorem base2", "sentence": "Sentence 2", "definition": "Definition 2", "romanisation": "Romanisation2", "tags": "tag2-1 " }, { "id": "30000000-0000-0000-0000-000000000000", "created": "2012-12-28T20:31:20.3934633+00:00", "modified": "2012-12-28T20:31:20.3934633+00:00", "textId": "7dc4a5f7-43ef-6509-c16b-39bef0a24203", "termId": "00000000-0000-0000-0000-000000000001", "baseTerm": "lorem base3", "sentence": "Sentence 3", "definition": "Definition 3", "romanisation": "Romanisation3", "tags": "tag3-1 " }] });
                 //var html = template({"id":"00000000-0000-0000-0000-000000000001","length":1,"individualTerms":[{"id":"10000000-0000-0000-0000-000000000000","baseTerm":"lorem base1","definition":"Definition 1","romanisation":"Romanisation1","tags":"tag1-1 ","title":"lorem base1"},{"id":"20000000-0000-0000-0000-000000000000","baseTerm":"lorem base2","definition":"Definition 2","romanisation":"Romanisation2","tags":"tag2-1 ","title":"lorem base2"},{"id":"30000000-0000-0000-0000-000000000000","baseTerm":"lorem base3","definition":"Definition 3","romanisation":"Romanisation3","tags":"tag3-1 ","title":"lorem base3"},{"id":"00000000-0000-0000-0000-000000000000","baseTerm":"","definition":null,"romanisation":"","tags":"","title":"New definition"}]});
                 //$('#formTerms').html(html);
                 //console.log(html);
                 
                 //$('#tabTermDefintions a:first').tab('show');
             </script>
         </text>, "body");
}