@{
    ViewBag.Title = "Texts";
    Bundles.AddInlineScript(
    @<text>
         <script language="javascript">
             function update() {
                 if($('#GroupId').val()=='') {
                     return false;
                 }
            
                 var texts = [];
                 $('input[type=checkbox]:checked').each(function (index, x) { texts.push($(x).val()); });
                 $('#texts').val(texts.join(','));
                 return true;
             }

             window.initWebGrid('@Url.Action("IndexGrid")');
         </script>
    </text>, "inline");
}

<div class="row-fluid">
    <div class="span12">
        <div class="filterbar">
            <input type="text" name="filter" id="filter" style="width: 70%" placeholder="search for language, title, collection name or tags eg: #shared, #audio, #parallel" />
            <select name="rowsPerPage" id="rowsPerPage" class="input-small">
                <option value="5">5</option>
                <option value="15">15</option>
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="100">100</option>
                <option value="250">250</option>
            </select>
            <a href="#" id="clearText">
                <i class="icon-remove" title="clear text filter"></i>
            </a>

            <a href="#" id="resetFilter">
                <i class="icon-refresh" title="clear the text filter, sort by and sort direction filter"></i>
            </a>
        </div>
        <div class="clr20"></div>
        <div id="grid"></div>
    </div>
</div>
<div class="row-fluid">
    <div class="span12">
        <a href="@Url.Action("Add")" class="btn btn-primary">Add a new text</a>
        <a href="@Url.Action("Import")" class="btn">Import texts</a>
        @{
            var groups = ViewBag.Groups as Dictionary<Guid, string>;

            if(groups != null && groups.Any())
            {
                using(Html.BeginForm("ShareTexts", "Texts", FormMethod.Post, new { @style = "display:inline;", onsubmit = "return update();" }))
                {
                    @Html.AntiForgeryToken()
                    <input type="hidden" name="texts" id="texts" />
                    @Html.DropDownList("GroupId", new SelectList(groups, "Key", "Value"), "Choose group", new { style = "margin-bottom:0;"})
                    <button type="submit" class="btn">share selected texts</button>
                }
            }
        }
    </div>
</div>
